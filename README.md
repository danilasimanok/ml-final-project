# ML Final Project

Финальный проект по курсу машинного обучения, обработка данных с ЦИАН

## Условия проекта

Выбран сайт cian.ru

С него извлечены данные по цене посуточной аренды квартиры в г. Санкт-Петербурге на 1 гостя.

|Признак|Тип|
|:---|---:|
|Тип|Категориальный|
|Площадь|Количественный|
|Этаж|Количественный|
|Всего этажей|Количественный|
|Станция|Категориальный|
|Время до станции|Количественный|
|Пешком?|Бинарный|
|Улица|Категориальный|
|Цена в день|Количественный|
|С залогом?|Бинарный|
|Залог|Количественный|

Всего записей: 6790

Данные были очищены от ошибок и визуализированы, взаимодействия между данными также были визуализированы. В результате были сформулированы гипотезы о существовании соответствий:

- площадь -> тип
- (цена, площадь) -> залог
- (улица, станция) -> время
- (площадь, станция, тип) -> цена

Для их проверки были выбраны 4 модели машинного обучения, к которым были подобраны гиперпараметры.

## Результаты

### площадь -> тип

Модель: `GradientBoostingClassifier`

Параметры: `{'criterion': 'friedman_mse', 'learning_rate': 0.1, 'loss': 'log_loss', 'max_features': 'auto'}`

Метрики:

```
              precision    recall  f1-score   support

           0       0.60      0.95      0.73       207
           1       0.86      0.68      0.76       622
           3       0.69      0.96      0.80       128
          13       0.92      0.84      0.88       467

    accuracy                           0.79      1424
   macro avg       0.77      0.86      0.79      1424
weighted avg       0.82      0.79      0.80      1424
```

### (цена, площадь) -> залог

Модель: `GradientBoostingClassifier`

Параметры: `{'criterion': 'friedman_mse', 'learning_rate': 1, 'loss': 'log_loss', 'max_features': 'log2'}`

Метрики:

```
              precision    recall  f1-score   support

           0       0.94      0.96      0.95       491
           1       0.89      0.87      0.88       265
           2       0.90      0.88      0.89       182

    accuracy                           0.92       938
   macro avg       0.91      0.90      0.91       938
weighted avg       0.92      0.92      0.92       938
```

### (улица, станция) -> время

Модель: `DecisionTreeRegressor`

Параметры: `{'criterion': 'poisson', 'max_features': 'log2', 'min_samples_leaf': 4, 'min_samples_split': 2, 'splitter': 'best'}`

Метрики:

```
MSE:  0.2772601815215786
MAE:  0.0738775342914865
R2:  0.9863327325996838
```

### (площадь, станция, тип) -> цена

Модель: `SVR`

Параметры: `{'C': 8, 'epsilon': 0.125, 'gamma': 'auto', 'kernel': 'rbf', 'tol': 1e-05}`

Метрики:

```
MSE:  42411.85531151236
MAE:  81.5678275983627
R2:  0.8882710938522076
```
